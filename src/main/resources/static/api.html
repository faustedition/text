<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
		  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Text Repository API (eu.interedition.text)</title>
  </head>

  <body>
	<h1>Text Repository API</h1>
	<h2>/</h2>
	<h3>POST</h3>
	<p>Examples:</p>
	<p>Creation of a base layer:</p>
	<pre>curl -i -X POST  -d '{"name":"layerName", "text":"abcd..."}' http://localhost:8080/ \
	-H "Content-Type: application/json"  -H "Accept: application/json"</pre>
	<p>Returns the id</p>
	<p>Example: <pre>{"id": 15}</pre></p>
	
	<p> Create an annotation</p>
	<pre>
	curl -i -X POST http://localhost:8080/ -H "Content-Type: application/json" -H "Accept: application/json" -d
{
    "name": "layerName",
    "text": "comments...",
    "targets": [
        {
            "id": 10,
            "ranges": [
                [
                    10,
                    20
                ],
                [
                    30,
                    40
                ]
            ]
        },
        {
            "id": 11,
            "ranges": [
                [
                    10,
                    20
                ],
                [
                    30,
                    40
                ],
                [
                    50,
                    60
                ]
            ]
        }
    ]
}</pre>
    <p>Returns the id</p>
    <p>Example: <pre>{"id": 15}</pre></p>
    <h2>/?q={query}</h2>

    <h3>GET</h3>
    
        <p>Query the repository</p>
    
        <p>Examples:</p>
    <pre>curl 'http://localhost:8080/?q=(range 20 30)' -H "Accept: application/json"</pre>
    <p>Returns an array of ids</p>
    <p>Example: <pre>[{"id": 15},{"id": 20}]</pre></p>
    
    <pre>curl 'http://localhost:8080/?q=(any)' -H "Accept: application/json"</pre>
    <p>Returns all layers</p>
    <p>Example: <pre>[{"name":["http://www.w3.org/XML/1998/namespace","document"],"anchors":[],"data":null,"id":2},{"name":["http://interedition.eu/ns","text"],"anchors":[{"t":{"name":["http://www.w3.org/XML/1998/namespace","document"],"id":2},"range":[0,1101]}],"data":null,"id":4},...]</pre></p>

    <h2>/{id}</h2>
    
	<h3>GET</h3>
	<p>Get a layer</p>
	<p>Example:</p> 
	<pre>http://localhost:8080/2049</pre>
	<p>Returns a layer</p>
	<p>Examples: <pre>
{
    "id": 2049,
    "name": "layerName",
    "text": "comments...",
    "targets": [
        {
            "id": 10,
            "ranges": [
                [
                    10,
                    20
                ],
                [
                    30,
                    40
                ]
            ]
        },
        {
            "id": 11,
            "ranges": [
                [
                    10,
                    20
                ],
                [
                    30,
                    40
                ],
                [
                    50,
                    60
                ]
            ]
        }
    ]
}	
	</pre></p>
	
	<h2>/{id}?q={query}</h2>
	<h3>GET</h3>
    <p>Query a layer</p>
    <p>Example:</p> 
    <pre>curl 'http://localhost:8080/2020?q=(range 20 30)' -H "Accept: application/json"</pre>
    <p>Returns an array of ids</p>
    <p>Example: <pre>[{"id": 15}]</pre></p>
	

	<h2>/xml-transform</h2>	
	<h3>POST</h3>
    <p>Feed XML to the repo</p>
    <p>Example: </p> 
    <pre> find . -name '*.xml' -exec curl -v -X POST -d @{} localhost:8080/xml-transform/ -H "Content-Type: application/xml" \;</pre>
    <p>Returns </p>
    <pre>
    HTTP/1.1 201 Created
    Location: http://localhost:8080/1080
    </pre>
    

</body>
</html>
